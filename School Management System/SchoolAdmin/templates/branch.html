{% extends 'header_footer.html' %}
{% block content %}
{% load static %}
<style>
   .custom-file-button {
   input[type="file"] {
   margin-left: -2px !important;
   &::-webkit-file-upload-button {
   display: none;
   }
   &::file-selector-button {
   display: none;
   }
   }
   &:hover {
   label {
   background-color: #dde0e3;
   cursor: pointer;
   }
   }
   }
   .center-cropped-profile {
   width: 120px;
   height: 120px;
   background-position: center center;
   background-repeat: no-repeat;
   }

   .center-cropped-profile2 {
    width: 70px;
    height: 70px;
    background-position: center center;
    background-repeat: no-repeat;
    }
</style>
<div class="page-wrapper">
   <div class="content container-fluid">
      <div class="page-header">
         <div class="row align-items-center">
            <div class="col">
               <h3 class="page-title">Branch</h3>
               <ul class="breadcrumb">
                  <li class="breadcrumb-item"><a href="teachers.html">Settings</a></li>
                  <li class="breadcrumb-item active">Branch</li>
               </ul>
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-sm-12">
            <div class="card">
               <div class="card-body">
                  <form enctype="multipart/form-data" id="frm" name="frm">
                     {% csrf_token %}
                     <input type="hidden" name="branchid" value="{{selectbranch.id}}">
                     <div class="row">
                        <div class="col-12">
                           <h5 class="form-title"><span>Basic Details</span></h5>
                        </div>
                        <div class="col-12 col-sm-4">
                           <div class="form-group local-forms">
                              <label>Branch Name <span class="login-danger">*</span></label>
                              <input type="text" class="form-control" placeholder="Enter Name" name="branch_name" value="{{selectbranch.branch_name}}">
                           </div>
                        </div>
                        <div class="col-8">
                           <div class="form-group local-forms">
                              <label>Branch Address <span class="login-danger">*</span></label>
                              <input type="text" class="form-control" placeholder="Enter address" name="branch_address" value="{{selectbranch.branch_address}}">
                           </div>
                        </div>
                        <div class="col-12">
                           <h5 class="form-title"><span>Login Details</span></h5>
                        </div>
                        <div class="col-sm-3 text-center">
                           {% if isedit == 1 %} 
                            <img src="{{ selectbranch.user_id.user_image.url }}" id="image_preview" alt="image" class="img-fluid rounded-circle center-cropped-profile"  style="margin-bottom:10px;">
                           {% else %}
                            <img src="{% static 'assets/user_default.jpg' %}" id="image_preview" alt="image" class="img-fluid rounded-circle center-cropped-profile"  style="margin-bottom:10px;">
                           {% endif %}
                           <div class="input-group custom-file-button">
                              <label class="input-group-text" for="inputGroupFile">Choose Photo</label>
                              <input type="file" class="form-control"  name="user_image" aria-label="file example" id="inputGroupFile" >
                           </div>
                        </div>
                        <div class="col-9">
                           <div class="col-12 col-sm-12">
                              <div class="form-group local-forms">
                                 <label>User Name <span class="login-danger">*</span></label>
                                 <input type="text" class="form-control" placeholder="Enter Username" name="user_name" value="{{selectbranch.user_id.user_name}}">
                              </div>
                           </div>
                           <div class="col-12 col-sm-12">
                              <div class="form-group local-forms">
                                 <label>Email ID <span class="login-danger">*</span></label>
                                 <input type="email" class="form-control" placeholder="Enter Mail Id" name="user_email" value="{{selectbranch.user_id.user_email}}">
                              </div>
                           </div>
                           <div class="col-12 col-sm-12">
                              <div class="form-group local-forms">
                                 <label>Password <span class="login-danger">*</span></label>
                                 <input type="text" class="form-control" placeholder="Enter Password" name="user_password" >
                              </div>
                           </div>
                        </div>
                        <div class="col-12">
                           <div class="student-submit">
                              <button type="button" class="btn btn-primary" onClick="ins(document.frm)">Save</button>
                           </div>
                        </div>
                     </div>
                  </form>
               </div>
            </div>
            <div class="card">
               <div class="card-header">
                  <h5 class="card-title mb-2">Branch</h5>
                  <p class="card-text">
                  </p>
               </div>
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="datatable table table-stripped">
                        <thead>
                           <tr>
                              <th>ID</th>
                              <th>Profile</th>
                              <th>Branch Details</th>
                              <th>User Details</th>
                              <th>Status</th>
                              <th>Action</th>
                           </tr>
                        </thead>
                        <tbody>
                            {% for row in all_branch %}
                           <tr>
                              <td>{{row.id}}</td>
                              <td> <img src="{{ row.user_id.user_image.url }}"  alt="Image" class="img-fluid rounded-circle center-cropped-profile2"/></td>
                              <td>{{row.branch_name}} <br>{{row.branch_address}} </td>
                              <td>{{row.user_id.user_name}} <br>{{row.user_id.user_email}}</td>
                              <td>
                                {% if row.user_id.user_status == 1 %}
                                <span class="badge bg-success">Active</span>
                                {% else %}
                                <span class="badge bg-danger">Deactive</span>
                                {% endif %}
                            </td>
                              <td>
                                <a href="{% url 'editBranch' row.id %}" class="btn btn-sm btn-rounded btn-primary"><i class="fa fa-edit" aria-hidden="true"></i></a>
                                <a href="{% url 'deleteBranch' row.id %}" class="btn btn-sm btn-rounded btn-danger"><i class="fa fa-trash" aria-hidden="true"></i></a>

                              </td>
                           </tr>
                           {% endfor %}
                        </tbody>
                     </table>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<script src="{% static 'assets/js/jquery-3.6.0.min.js' %}"></script>
<script>
    function ins(frm)
    {
        var f1 = new FormData(frm);
       
        // $("#frm").serialize();
        //	var dt = $(frm).serialize();
        $.ajax({
            url:'{% url "addbranch" %}',
            type:"post",
            data:f1,
            processData:false,
            contentType:false,
            dataType:"json",
            success:function(data)
            {
                $('#frm')[0].reset(); 
            }
        });
    }
</script>

<script>
    $(document).ready(function(){
      
      });
      
</script>

{% endblock %}


